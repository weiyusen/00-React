{"ast":null,"code":"import { createSlice } from \"@reduxjs/toolkit\";\nexport const authSlice = createSlice({\n  name: 'auth',\n  // 初始值\n  initialState: () => {\n    const token = localStorage.getItem('token');\n\n    if (!token) {\n      return {\n        isLogged: false,\n        token: null,\n        //服务器发送给我们的token默认有效期为1个月\n        user: null,\n        expirationTime: 0 //登录状态失效时间\n\n      };\n    }\n\n    return {\n      isLogged: true,\n      token: token,\n      user: JSON.parse(localStorage.getItem('user')),\n      expirationTime: +localStorage.getItem('expirationTime')\n    };\n  },\n  reducers: {\n    login(state, action) {\n      console.log(action, state);\n      state.isLogged = true;\n      state.token = action.payload.token;\n      state.user = action.payload.user; // 获取当前时间戳\n\n      const currentTime = Date.now(); // 设置登录的有效时间\n\n      const timeout = 1000 * 60 * 60 * 24 * 7; //一周\n\n      state.expirationTime = c; // 将数据同时存储到本地存储中\n\n      localStorage.setItem('token', state.token);\n      localStorage.setItem('user', JSON.stringify(state.user));\n    },\n\n    logout(state) {\n      state.isLogged = false;\n      state.token = null;\n      state.user = null;\n      localStorage.removeItem('token');\n      localStorage.removeItem('user');\n    }\n\n  }\n});\nexport const {\n  login,\n  logout\n} = authSlice.actions;","map":{"version":3,"names":["createSlice","authSlice","name","initialState","token","localStorage","getItem","isLogged","user","expirationTime","JSON","parse","reducers","login","state","action","console","log","payload","currentTime","Date","now","timeout","c","setItem","stringify","logout","removeItem","actions"],"sources":["D:/前端学习/00-react/00-React/05_React-Router/08_auth-demo/src/store/reducer/authSlice.js"],"sourcesContent":["import { createSlice } from \"@reduxjs/toolkit\";\r\n\r\nexport const authSlice = createSlice({\r\n    name: 'auth',\r\n    // 初始值\r\n    initialState: () => {\r\n        const token = localStorage.getItem('token')\r\n        if (!token) {\r\n            return {\r\n                isLogged: false,\r\n                token: null, //服务器发送给我们的token默认有效期为1个月\r\n                user: null,\r\n                expirationTime:0 //登录状态失效时间\r\n            }\r\n        }\r\n        return {\r\n            isLogged: true,\r\n            token: token,\r\n            user: JSON.parse(localStorage.getItem('user')),\r\n            expirationTime:+localStorage.getItem('expirationTime')\r\n        }\r\n    },\r\n    reducers: {\r\n        login(state, action) {\r\n            console.log(action, state);\r\n            state.isLogged = true\r\n            state.token = action.payload.token\r\n            state.user = action.payload.user\r\n            // 获取当前时间戳\r\n            const currentTime = Date.now()\r\n            // 设置登录的有效时间\r\n            const timeout = 1000*60*60*24*7 //一周\r\n            state.expirationTime = c\r\n\r\n            // 将数据同时存储到本地存储中\r\n            localStorage.setItem('token', state.token)\r\n            localStorage.setItem('user', JSON.stringify(state.user))\r\n        },\r\n        logout(state) {\r\n            state.isLogged = false\r\n            state.token = null\r\n            state.user = null\r\n\r\n            localStorage.removeItem('token')\r\n            localStorage.removeItem('user')\r\n        }\r\n    }\r\n})\r\n\r\nexport const { login, logout } = authSlice.actions"],"mappings":"AAAA,SAASA,WAAT,QAA4B,kBAA5B;AAEA,OAAO,MAAMC,SAAS,GAAGD,WAAW,CAAC;EACjCE,IAAI,EAAE,MAD2B;EAEjC;EACAC,YAAY,EAAE,MAAM;IAChB,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAd;;IACA,IAAI,CAACF,KAAL,EAAY;MACR,OAAO;QACHG,QAAQ,EAAE,KADP;QAEHH,KAAK,EAAE,IAFJ;QAEU;QACbI,IAAI,EAAE,IAHH;QAIHC,cAAc,EAAC,CAJZ,CAIc;;MAJd,CAAP;IAMH;;IACD,OAAO;MACHF,QAAQ,EAAE,IADP;MAEHH,KAAK,EAAEA,KAFJ;MAGHI,IAAI,EAAEE,IAAI,CAACC,KAAL,CAAWN,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CAHH;MAIHG,cAAc,EAAC,CAACJ,YAAY,CAACC,OAAb,CAAqB,gBAArB;IAJb,CAAP;EAMH,CAnBgC;EAoBjCM,QAAQ,EAAE;IACNC,KAAK,CAACC,KAAD,EAAQC,MAAR,EAAgB;MACjBC,OAAO,CAACC,GAAR,CAAYF,MAAZ,EAAoBD,KAApB;MACAA,KAAK,CAACP,QAAN,GAAiB,IAAjB;MACAO,KAAK,CAACV,KAAN,GAAcW,MAAM,CAACG,OAAP,CAAed,KAA7B;MACAU,KAAK,CAACN,IAAN,GAAaO,MAAM,CAACG,OAAP,CAAeV,IAA5B,CAJiB,CAKjB;;MACA,MAAMW,WAAW,GAAGC,IAAI,CAACC,GAAL,EAApB,CANiB,CAOjB;;MACA,MAAMC,OAAO,GAAG,OAAK,EAAL,GAAQ,EAAR,GAAW,EAAX,GAAc,CAA9B,CARiB,CAQe;;MAChCR,KAAK,CAACL,cAAN,GAAuBc,CAAvB,CATiB,CAWjB;;MACAlB,YAAY,CAACmB,OAAb,CAAqB,OAArB,EAA8BV,KAAK,CAACV,KAApC;MACAC,YAAY,CAACmB,OAAb,CAAqB,MAArB,EAA6Bd,IAAI,CAACe,SAAL,CAAeX,KAAK,CAACN,IAArB,CAA7B;IACH,CAfK;;IAgBNkB,MAAM,CAACZ,KAAD,EAAQ;MACVA,KAAK,CAACP,QAAN,GAAiB,KAAjB;MACAO,KAAK,CAACV,KAAN,GAAc,IAAd;MACAU,KAAK,CAACN,IAAN,GAAa,IAAb;MAEAH,YAAY,CAACsB,UAAb,CAAwB,OAAxB;MACAtB,YAAY,CAACsB,UAAb,CAAwB,MAAxB;IACH;;EAvBK;AApBuB,CAAD,CAA7B;AA+CP,OAAO,MAAM;EAAEd,KAAF;EAASa;AAAT,IAAoBzB,SAAS,CAAC2B,OAApC"},"metadata":{},"sourceType":"module"}