{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useDispatch, useSelector } from 'react-redux';\nimport { logout } from '../st';\nimport { useEffect } from 'react';\n\nconst useAutoLogout = () => {\n  _s();\n\n  const auth = useSelector(state => state.auth);\n  const dispatch = useDispatch(); // 创建一个useEffect, 用来处理登录状态\n\n  useEffect(() => {\n    const timeout = auth.expirationTime - Date.now();\n\n    if (timeout < 6000) {\n      // 小于6秒就直接登出\n      dispatch(logout());\n      return;\n    }\n\n    const timer = setTimeout(() => {\n      dispatch(logout());\n    }, timeout);\n    return () => {\n      //返回一个清理定时器的函数 会自动执行\n      // console.log(111); \n      clearTimeout(timer);\n    };\n  }, [auth]);\n};\n\n_s(useAutoLogout, \"2AxE5/iV/zzvSF1cLSwWWofHrXs=\", false, function () {\n  return [useSelector, useDispatch];\n});\n\nexport default useAutoLogout;","map":{"version":3,"names":["useDispatch","useSelector","logout","useEffect","useAutoLogout","auth","state","dispatch","timeout","expirationTime","Date","now","timer","setTimeout","clearTimeout"],"sources":["D:/前端学习/00-react/00-React/05_React-Router/08_auth-demo/src/hooks/useAutoLogout.js"],"sourcesContent":["import { useDispatch, useSelector } from 'react-redux';\r\nimport { logout } from '../st';\r\nimport {useEffect} from 'react';\r\n\r\nconst useAutoLogout = () => {\r\n    const auth = useSelector(state => state.auth)\r\n    const dispatch = useDispatch()\r\n\r\n    // 创建一个useEffect, 用来处理登录状态\r\n    useEffect(() => {\r\n        const timeout = auth.expirationTime - Date.now()\r\n        if(timeout < 6000){\r\n            // 小于6秒就直接登出\r\n            dispatch(logout())\r\n            return;\r\n        }\r\n        const timer = setTimeout(() => {dispatch(logout())}, timeout)\r\n        return () => { //返回一个清理定时器的函数 会自动执行\r\n            // console.log(111); \r\n            clearTimeout(timer)\r\n        }\r\n    }, [auth]);\r\n}\r\n\r\nexport default useAutoLogout"],"mappings":";;AAAA,SAASA,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA,SAASC,MAAT,QAAuB,OAAvB;AACA,SAAQC,SAAR,QAAwB,OAAxB;;AAEA,MAAMC,aAAa,GAAG,MAAM;EAAA;;EACxB,MAAMC,IAAI,GAAGJ,WAAW,CAACK,KAAK,IAAIA,KAAK,CAACD,IAAhB,CAAxB;EACA,MAAME,QAAQ,GAAGP,WAAW,EAA5B,CAFwB,CAIxB;;EACAG,SAAS,CAAC,MAAM;IACZ,MAAMK,OAAO,GAAGH,IAAI,CAACI,cAAL,GAAsBC,IAAI,CAACC,GAAL,EAAtC;;IACA,IAAGH,OAAO,GAAG,IAAb,EAAkB;MACd;MACAD,QAAQ,CAACL,MAAM,EAAP,CAAR;MACA;IACH;;IACD,MAAMU,KAAK,GAAGC,UAAU,CAAC,MAAM;MAACN,QAAQ,CAACL,MAAM,EAAP,CAAR;IAAmB,CAA3B,EAA6BM,OAA7B,CAAxB;IACA,OAAO,MAAM;MAAE;MACX;MACAM,YAAY,CAACF,KAAD,CAAZ;IACH,CAHD;EAIH,CAZQ,EAYN,CAACP,IAAD,CAZM,CAAT;AAaH,CAlBD;;GAAMD,a;UACWH,W,EACID,W;;;AAkBrB,eAAeI,aAAf"},"metadata":{},"sourceType":"module"}